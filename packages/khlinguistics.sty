% khling.sty
% Macros for linguistics
%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{khlinguistics}

\RequirePackage{etoolbox}
\RequirePackage{xspace}
\RequirePackage{amsmath} % bmatrix, Bmatrix

% load amssym only if needed -- other packages may provide these symbols
\@ifundefined{varnothing}{\RequirePackage{amssymb}}{}

\RequirePackage[only,llbracket,rrbracket]{stmaryrd} % double brackets
\RequirePackage{pifont} % checkmark and x-mark symbols

%% load just \{l,r,u,d}times from mathdesign
\DeclareFontEncoding{MDA}{}{}
\DeclareFontSubstitution{MDA}{cmr}{m}{n}
\DeclareSymbolFont{mathdesignA}{MDA}{mdput}{m}{n}
\SetSymbolFont{mathdesignA}{bold}{MDA}{mdput}{b}{n}
\DeclareMathSymbol{\ltimes}{\mathbin}{mathdesignA}{"6E}
\DeclareMathSymbol{\rtimes}{\mathbin}{mathdesignA}{"6F}
\DeclareMathSymbol{\udtimes}{\mathbin}{mathdesignA}{"5D}
\DeclareMathSymbol{\utimes}{\mathbin}{mathdesignA}{"5E}
\DeclareMathSymbol{\dtimes}{\mathbin}{mathdesignA}{"5F}

%% text symbols
\newcommand{\emptystr}{$\varepsilon$\xspace}
\newcommand{\zero}{$\varnothing$\xspace}
\newcommand{\gap}{\rule{1em}{.5pt}\xspace}
\newcommand{\chkmark}{\ding{51}\xspace}
\newcommand{\xmark}{\ding{55}\xspace}

\newcommand{\lrarrow}{$\leftrightarrow$\xspace}
\newcommand{\larrow}{$\leftarrow$\xspace}
\newcommand{\rarrow}{$\rightarrow$\xspace}

%% math symbols
\renewcommand{\emptyset}{$\varnothing$}


%
% Brackets
%

%% matched brackets
\newcommand{\setof}[1]{\{#1\}}
\newcommand{\tuple}[1]{$\langle$#1$\rangle$}
\newcommand{\anglebr}[1]{$\langle$#1$\rangle$}
\newcommand{\dblsqbr}[1]{$\llbracket$#1$\rrbracket$}

%% Big brackets -- create single column array
%% from a comma-separated list

\newcommand*{\textmatrixline}[1]{\text{#1}\\}

\newcommand*{\bigsqbr}[1]{%
  \(%
    \begin{bmatrix}%
      \forcsvlist{\textmatrixline}{#1}%
    \end{bmatrix}%
  \)%
}

\newcommand*{\bigcurlybr}[1]{%
  \(%
    \begin{Bmatrix}%
      \forcsvlist{\textmatrixline}{#1}%
    \end{Bmatrix}%
  \)%
}


%
% Phonology
%

\newcommand{\ur}[1]{/#1/}
\newcommand{\sr}[1]{[#1]}

%
% Syntax
%

%% syntactic categories
\newcommand{\emptyD}{\zero{}$_{D}$\xspace}
\newcommand{\emptyT}{\zero{}$_{T}$\xspace}
\newcommand{\lv}{\textit{\rmfamily v}\xspace}
\newcommand{\lvb}{\textit{\rmfamily v}$'$\xspace}
\newcommand{\lvp}{\textit{\rmfamily v}P\xspace}
\newcommand{\Tpast}{T$_\textsc{past}$\xspace}
\newcommand{\Tpres}{T$_\textsc{pres}$\xspace}

%% PS brackets with optional labels
\newcommand{\psbr}[2][]{$[_{\text{\tiny #1}}$\hspace{.08em}#2\hspace{.08em}$]$}

%% Properly formatted trace with an optional index
\newcommand*{\tr}[1][]{\textit{t}\textsubscript{#1}\xspace}

%
% Semantics
%

\newcommand{\semtype}[1]{\ensuremath{\langle#1\rangle}}
\newcommand{\typeet}{\semtype{e,t}}
\newcommand{\typeeet}{\semtype{e,\semtype{e,t}}}
\newcommand{\typeett}{\semtype{\semtype{e,t},t}}
\newcommand{\typeetet}{\semtype{\semtype{e,t},\semtype{e,t}}}

\newcommand{\denot}[2][]{\dblsqbr{#2}$^{#1}$}

%
% Mathling
%

%% tree node relations
\newcommand{\idom}{\triangleleft}
\newcommand{\pdom}{\triangleleft^+}
\newcommand{\rdom}{\triangleleft^*}
\newcommand{\tieridom}{\triangleleft_T}
\newcommand{\tierprec}{\prec_T}

%% tree elements
\newcommand{\ledge}{\ensuremath{\rtimes}}
\newcommand{\redge}{\ensuremath{\ltimes}}
\newcommand{\tedge}{\ensuremath{\dtimes}}
\newcommand{\bedge}{\ensuremath{\utimes}}
\newcommand{\slot}{\ensuremath{\Box}}

%% MGs
\newcommand{\mgli}[2]{#1 :: \texttt{#2}}
\newcommand{\mgflist}[1]{$\langle$#1$\rangle$}
\newcommand{\mgfstr}[1]{\texttt{#1}}
\newcommand{\mergedot}{$\circ$\xspace}